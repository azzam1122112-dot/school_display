{% load static %}
<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="color-scheme" content="dark">
  <title>{% if school_name %}{{ school_name }} â€” {% endif %}Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙƒÙŠØ©</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="{% static 'css/app.css' %}?v=20251215-display">

  <style>
    html,body{height:100%} body{margin:0}
    .display-board{font-family:"IBM Plex Sans Arabic",system-ui,-apple-system,"Segoe UI",Arial,sans-serif}
    .hidden{display:none !important}

    /* ===== TV Layout (Ø§Ø­ØªØ±Ø§ÙÙŠ + Ø¨Ø¯ÙˆÙ† Ø¶ØºØ· Ø§Ù„Ù‡ÙŠØ±Ùˆ) ===== */
    .display-board{
      min-height: 100svh;
      min-height: calc(var(--vh, 1vh) * 100);
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .header-card{flex:0 0 auto}

    .main-grid{
      flex:1 1 auto;
      min-height:0;
      display:grid;
      gap:16px;
      padding:16px;
      grid-template-columns: minmax(0, 1fr) minmax(340px, 36%);
      align-items:stretch;
    }

    /* Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ: ØªÙ†Ø¨ÙŠÙ‡ ØµØºÙŠØ± + Ù‡ÙŠØ±Ùˆ ÙŠØªÙ…Ø¯Ø¯ + Ø´Ø±Ù ÙŠØ£Ø®Ø° Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ */
    .col-main{
      min-height:0;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    /* âœ… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡: Ø³Ø·Ø±ÙŠÙ† ÙÙ‚Ø· + ØªÙƒØ¨ÙŠØ± Ø®Ø· ÙÙ‚Ø· Ø¨Ø¯ÙˆÙ† ØªÙƒØ¨ÙŠØ± Ø§Ù„Ù‚Ø³Ù… */
    .alert-card{
      flex:0 0 auto;
    }
    .alert-inner{
      padding:14px 16px; /* Ø«Ø§Ø¨Øª ÙˆØµØºÙŠØ± */
    }
    .alert-divider{
      margin:8px 0;
      opacity:.7;
    }
    .alert-title{
      font-size: 26px;            /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· */
      line-height: 1.2;
      font-weight: 900;
      white-space: nowrap;        /* Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ */
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .alert-details{
      font-size: 20px;            /* ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø· */
      line-height: 1.45;
      opacity:.95;
      white-space: nowrap;        /* Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ */
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Ø§Ù„Ù‡ÙŠØ±Ùˆ ÙŠØªÙ…Ø¯Ø¯ Ø·Ø¨ÙŠØ¹ÙŠ */
    .hero-card{
      flex: 1 1 auto;
      min-height:0;
      display:flex;
      flex-direction:column;
    }
    .hero-top{flex:1 1 auto; min-height:0}
    .hero-bottom{flex:0 0 auto}

    /* Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù: ØªØ£Ø®Ø° Ø§Ù„ÙØ±Ø§Øº Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ† ØªØ¶Ø®ÙŠÙ… Ù…Ø¨Ø§Ù„Øº */
    .honor-card{
      flex: 0 0 28%;
      min-height: 220px;
      max-height: 360px;
      display:flex;
      align-items:stretch;
      gap:14px;
      min-height:0;
    }
    .honor-left{
      flex:0 0 auto;
      display:flex;
      flex-direction:column;
      justify-content:center;
      min-width: 210px;
    }
    .honor-slot{
      flex:1 1 auto;
      min-height:0;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    /* Ø§Ù„Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Ø§Ù„ÙŠØ³Ø§Ø±): ÙƒØ±ØªÙŠÙ† Ø«Ø§Ø¨ØªÙŠÙ† Ø¨Ø¯ÙˆÙ† ØªØ¯Ø§Ø®Ù„ */
    .col-side{
      min-height:0;
      display:flex;
      flex-direction:column;
      gap:16px;
    }
    .col-side .list-card{
      flex:1 1 0;
      min-height:0;
      display:flex;
      flex-direction:column;
    }
    .list-viewport,
    .standby-viewport{
      flex:1 1 0;
      min-height:0;
      overflow:hidden;
    }
    .track{will-change:transform}

    /* ØªØ­Ø³ÙŠÙ† Ø¨Ø³ÙŠØ· Ù„Ù„Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø£Ù‚ØµØ± */
    @media (max-height: 820px){
      .alert-title{font-size:24px}
      .alert-details{font-size:18px}
      .honor-card{min-height:200px; max-height:320px}
    }

    /* ===== Blocking overlay (device bound) ===== */
    .blocker{
      position: fixed;
      inset: 0;
      z-index: 99999;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px;
      background: rgba(2, 6, 23, 0.78);
      backdrop-filter: blur(10px);
    }
    .blocker-card{
      width: min(920px, 100%);
      text-align: center;
      padding: 22px 22px;
    }
    .blocker-title{font-size: 34px; font-weight: 900; line-height: 1.2; margin: 0;}
    .blocker-details{font-size: 20px; line-height: 1.6; opacity: .92; margin: 10px 0 0;}
    .blocker-code{margin-top: 12px; font-size: 18px; opacity: .9;}
    .blocker-code span{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;}
    .blocker-hint{margin-top: 14px; font-size: 16px; opacity: .82;}
    .blocker-steps{margin: 14px auto 0; max-width: 720px; text-align: right; direction: rtl;}
    .blocker-steps .chip{display:inline-flex; margin-inline:4px;}
  </style>
</head>

<body
  class="display-board"
  data-theme="{% if theme %}{{ theme }}{% else %}indigo{% endif %}"
  data-token="{% if api_token %}{{ api_token }}{% endif %}"
  data-api-token="{% if api_token %}{{ api_token }}{% endif %}"
  data-snapshot-url="{% if snapshot_url %}{{ snapshot_url }}{% endif %}"
  data-school-id="{% if school_id %}{{ school_id }}{% endif %}"
  data-school-type="{% if school_type %}{{ school_type }}{% endif %}"
  data-media-prefix="{% if MEDIA_URL %}{{ MEDIA_URL }}{% else %}/media/{% endif %}"
  data-refresh="{% if refresh_interval_sec %}{{ refresh_interval_sec }}{% else %}10{% endif %}"
  data-standby="{% if standby_scroll_speed %}{{ standby_scroll_speed }}{% else %}0.8{% endif %}"
  data-periods-speed="{% if periods_scroll_speed %}{{ periods_scroll_speed }}{% else %}0.5{% endif %}"
>
  <div class="mesh-bg" aria-hidden="true"></div>

  <!-- Blocking overlay (hidden by default) -->
  <div id="blocker" class="blocker hidden" role="alert" aria-live="assertive">
    <div class="card blocker-card">
      <h2 id="blockerTitle" class="blocker-title">Ù‡Ø°Ù‡ Ø§Ù„Ø´Ø§Ø´Ø© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø¬Ù‡Ø§Ø² Ø¢Ø®Ø±</h2>
      <p id="blockerDetails" class="blocker-details">
        Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ø±Ø§Ø¨Ø· Ø¹Ù„Ù‰ Ø£ÙƒØ«Ø± Ù…Ù† ØªÙ„ÙØ§Ø².
      </p>
      <div class="blocker-code">Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ: <span id="blockerLink">â€”</span></div>
      <div class="blocker-hint">Ù„Ù„Ù†Ù‚Ù„ Ø¥Ù„Ù‰ ØªÙ„ÙØ§Ø² Ø¬Ø¯ÙŠØ¯: Ø§ÙØµÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø² Ù…Ù† Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ….</div>
      <div class="blocker-steps">
        <div class="chip chip-muted">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</div>
        <span class="chip chip-muted">â†’</span>
        <div class="chip chip-muted">Ø´Ø§Ø´Ø§Øª Ø§Ù„Ø¹Ø±Ø¶</div>
        <span class="chip chip-muted">â†’</span>
        <div class="chip chip-muted">ÙØµÙ„ Ø§Ù„Ø¬Ù‡Ø§Ø²</div>
      </div>
    </div>
  </div>

  <header class="card header-card">
    <div class="header-left">
      <div class="logo-box" aria-label="Ø´Ø¹Ø§Ø± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©">
        <img
          id="schoolLogo"
          src="{% if logo_url %}{{ logo_url }}{% endif %}"
          class="{% if logo_url %}logo-img{% else %}hidden{% endif %}"
          alt="Logo"
          loading="eager"
          decoding="async"
        >
        <div
          id="schoolLogoFallback"
          class="{% if logo_url %}hidden{% endif %}logo-fallback"
          aria-hidden="true"
        >ğŸ«</div>
      </div>

      <div class="header-text">
        <h1 id="schoolName" class="header-title">
          {% if school_name %}{{ school_name }}{% else %}Ù„ÙˆØ­Ø© Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø°ÙƒÙŠØ©{% endif %}
        </h1>

        <div class="header-meta">
          <span id="dateGregorian" class="truncate"></span>
          <span class="dot" aria-hidden="true"></span>
          <span id="dateHijri" class="truncate hijri"></span>
        </div>
      </div>
    </div>

    <div class="header-right">
      <div id="clock" class="clock num-font">--:--</div>
    </div>
  </header>

  <main class="main-grid">
    <section class="col-main">
      <div class="card alert-card">
        <div id="alertContainer" class="alert-inner">
          <div id="alertTitle" class="alert-title">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡â€¦</div>
          <div class="alert-divider" aria-hidden="true"></div>
          <div id="alertDetails" class="alert-details">...</div>
        </div>
      </div>

      <div class="card hero-card">
        <div class="hero-top">
          <div class="hero-left">
            <div class="hero-row">
              <span id="badgeKind" class="chip">--</span>
              <span id="heroRange" class="hero-range num-font">--:--</span>
            </div>

            <h2 id="heroTitle" class="hero-title">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</h2>

            <div class="hero-schedule">
              <div class="hero-schedule-label">Ø§Ù„Ù†Ø´Ø§Ø· Ø§Ù„Ø­Ø§Ù„ÙŠ:</div>
              <div id="currentScheduleList" class="hero-schedule-list">
                <span class="chip chip-muted">...</span>
              </div>
            </div>
          </div>

          <div class="hero-progress" aria-label="Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ">
            <svg class="progress-svg" viewBox="0 0 120 120" aria-hidden="true">
              <circle cx="60" cy="60" r="54" class="progress-track" />
              <circle
                id="circleProgress"
                cx="60" cy="60" r="54"
                class="progress-bar"
                style="stroke-dasharray:339.292; stroke-dashoffset:339.292;"
              />
            </svg>

            <div class="progress-center">
              <span id="countdown" class="countdown num-font">--:--</span>
              <span class="countdown-label">Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</span>
            </div>
          </div>
        </div>

        <div class="hero-bottom">
          <div class="hero-bottom-title">Ù…Ø³Ø§Ø± Ø§Ù„ÙŠÙˆÙ…</div>

          <div id="miniSchedule" class="mini-schedule no-scrollbar mask-gradient-x" aria-label="Ù…Ø³Ø§Ø± Ø§Ù„ÙŠÙˆÙ…">
            <span class="mini-loading">Ø¬Ø§Ø±ÙŠ Ø¬Ù„Ø¨ Ø§Ù„Ø¬Ø¯ÙˆÙ„...</span>
          </div>

          <div class="next-box">
            <div class="next-hint">Ø§Ù„ØªØ§Ù„ÙŠ Ù…Ø¨Ø§Ø´Ø±Ø©</div>
            <div id="nextLabel" class="next-label truncate">--</div>
          </div>
        </div>

        <div class="hero-progressline" aria-hidden="true">
          <div id="progressBar" class="hero-progressfill"></div>
        </div>
      </div>

      <div class="card honor-card">
        <div class="honor-left">
          <div class="honor-title">Ù„ÙˆØ­Ø© Ø§Ù„Ø´Ø±Ù</div>
          <div class="honor-count">
            <span><span id="exIndex">0</span> / <span id="exTotal">0</span></span>
          </div>
        </div>

        <div id="exSlot" class="honor-slot">
          <div class="honor-loading">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>
        </div>
      </div>
    </section>

    <aside class="col-side">
      <div class="card list-card">
        <div class="list-head">
          <div class="list-title ok">Ø­ØµØµ Ø¬Ø§Ø±ÙŠØ©</div>
          <span id="pcCount" class="chip chip-ok num-font">0</span>
        </div>
        <div class="list-viewport standby-viewport">
          <div id="periodClassesTrack" class="track"></div>
        </div>
      </div>

      <div class="card list-card">
        <div class="list-head">
          <div class="list-title warn">Ø­ØµØµ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±</div>
          <span id="sbCount" class="chip chip-warn num-font">0</span>
        </div>
        <div class="list-viewport standby-viewport">
          <div id="standbyTrack" class="track"></div>
        </div>
      </div>
    </aside>
  </main>

  <button id="fsBtn" class="fs-btn" type="button" aria-label="Fullscreen" title="Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©">â›¶</button>

  <noscript>
    <div class="no-js">
      Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªØ­ØªØ§Ø¬ JavaScript Ù„Ù„Ø¹Ù…Ù„ Ø¹Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ø¹Ø±Ø¶.
    </div>
  </noscript>

  <script src="{% static 'js/display.js' %}?v=20251215-final-3files-2"></script>
</body>
</html>
  