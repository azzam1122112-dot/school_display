{% load static %}
<!doctype html>
<html lang="ar" dir="rtl" class="h-full antialiased">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="mobile-web-app-capable" content="yes">
  <title>{% if school_name %}{{ school_name }} โ {% endif %}ููุญุฉ ุงูุนุฑุถ ุงูุฐููุฉ</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Arabic:wght@200;300;400;500;600;700&display=swap" rel="stylesheet">

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{% static 'css/app.css' %}?v=20251215-display">
</head>

<body
  class="display-board flex flex-col selection:bg-[var(--accent-main)] selection:text-white"
  data-theme="{% if theme %}{{ theme }}{% else %}indigo{% endif %}"
  data-token="{% if api_token %}{{ api_token }}{% endif %}"
  data-api-token="{% if api_token %}{{ api_token }}{% endif %}"
  data-snapshot-url="{% if snapshot_url %}{{ snapshot_url }}{% endif %}"
  data-school-id="{% if school_id %}{{ school_id }}{% endif %}"
  data-media-prefix="{% if MEDIA_URL %}{{ MEDIA_URL }}{% else %}/media/{% endif %}"
  data-refresh="{% if refresh_interval_sec %}{{ refresh_interval_sec }}{% else %}10{% endif %}"
  data-standby="{% if standby_scroll_speed %}{{ standby_scroll_speed }}{% else %}0.8{% endif %}"
  data-periods-speed="{% if periods_scroll_speed %}{{ periods_scroll_speed }}{% else %}0.5{% endif %}"
>
  <div class="mesh-bg"></div>

  <header class="bento-card px-6 py-3 flex items-center justify-between gap-4 shrink-0 min-h-[96px] z-10 animate-enter">
    <div class="flex items-center gap-5">
      <div class="h-16 w-16 rounded-3xl bg-white/5 border border-white/10 p-1.5 flex items-center justify-center shrink-0 shadow-inner overflow-hidden">
        <img id="schoolLogo" src="{% if logo_url %}{{ logo_url }}{% endif %}" class="{% if logo_url %}h-full w-full object-contain{% else %}hidden{% endif %}" alt="Logo">
        <div id="schoolLogoFallback" class="{% if logo_url %}hidden{% endif %}h-full w-full rounded-2xl bg-gradient-to-br from-[var(--accent-main)] to-[var(--accent-sub)] flex items-center justify-center text-3xl">
          ๐ซ
        </div>
      </div>

      <div class="flex flex-col justify-center min-w-0">
        <h1 id="schoolName" class="font-black text-white tracking-tight" style="font-size:var(--h1); line-height:1.15;">
          {% if school_name %}{{ school_name }}{% else %}ููุญุฉ ุงูุนุฑุถ ุงูุฐููุฉ{% endif %}
        </h1>
        <div class="flex items-center gap-2 text-slate-200 mt-1 overflow-hidden" style="font-size:var(--meta);">
          <span id="dateGregorian" class="truncate"></span>
          <span class="w-1 h-1 rounded-full bg-slate-500"></span>
          <span id="dateHijri" class="truncate text-[var(--accent-sub)] opacity-90"></span>
        </div>
      </div>
    </div>

    <div class="flex items-center gap-4 pl-4 border-l border-white/10">
      <div id="clock" class="num-font font-black text-white tracking-tight drop-shadow-lg" style="font-size:var(--clock); line-height:1;">
        --:--
      </div>
    </div>
  </header>

  <main class="flex-1 grid grid-cols-12 min-h-0" style="gap:var(--gap);">

    <div class="col-span-12 xl:col-span-8 flex flex-col min-h-0" style="gap:var(--gap);">

      <section class="bento-card px-6 py-4 animate-enter shrink-0">
        <div id="alertContainer" class="px-5 py-4">
          <div id="alertTitle" class="alert-title">ุฌุงุฑู ุชุญููู ุงูุชูุจููโฆ</div>
          <div class="alert-divider"></div>
          <div id="alertDetails" class="alert-details">...</div>
        </div>
      </section>

      <section class="bento-card hero-card-gradient flex-[2] flex flex-col relative group animate-enter shadow-2xl min-h-0">
        <div class="flex-1 flex items-center justify-between p-6 md:p-8 relative z-10 min-h-0">
          <div class="flex flex-col justify-center gap-4 max-w-2xl min-w-0">
            <div class="flex items-center gap-3">
              <span id="badgeKind" class="chip">--</span>
              <span id="heroRange" class="text-slate-100 num-font opacity-90 tracking-wide" style="font-size:var(--sub);">--:--</span>
            </div>

            <h2 id="heroTitle" class="font-black text-white tracking-tight drop-shadow-2xl leading-[1.1]" style="font-size:var(--hero);">
              ุฌุงุฑู ุงูุชุญููู...
            </h2>

            <div class="mt-2">
              <span class="text-indigo-100/90 font-semibold block mb-2" style="font-size:var(--meta);">ุงููุดุงุท ุงูุญุงูู:</span>
              <div id="currentScheduleList" class="flex flex-wrap gap-2">
                <span class="chip opacity-70">...</span>
              </div>
            </div>
          </div>

          <div class="relative w-40 h-40 md:w-52 md:h-52 shrink-0 hidden lg:block mr-2 md:mr-4">
            <svg class="w-full h-full -rotate-90 filter drop-shadow-[0_0_16px_rgba(99,102,241,0.55)]" viewBox="0 0 120 120">
              <circle cx="60" cy="60" r="54" stroke="rgba(255,255,255,0.2)" stroke-width="6" fill="none"/>
              <circle
                id="circleProgress"
                cx="60" cy="60" r="54"
                stroke="var(--accent-honor)"
                stroke-width="6"
                fill="none"
                stroke-linecap="round"
                style="stroke-dasharray:339.292; stroke-dashoffset:339.292; transition:stroke-dashoffset 1s linear;"
              />
            </svg>
            <div class="absolute inset-0 flex flex-col items-center justify-center">
              <span id="countdown" class="num-font font-black text-white tracking-tight" style="font-size:clamp(34px,2.6vw,70px);">--:--</span>
              <span class="text-indigo-50 mt-1 tracking-widest font-semibold" style="font-size:12px;">ุงููุชุจูู</span>
            </div>
          </div>
        </div>

        <div class="relative z-20 bg-slate-950/45 backdrop-blur-xl border-t border-white/5 px-5 md:px-6 py-4">
          <div class="flex items-center gap-4 md:gap-5">
            <div class="flex items-center gap-2 font-black text-indigo-100 shrink-0" style="font-size:var(--meta);">
              <span>ูุณุงุฑ ุงูููู</span>
            </div>

            <div id="miniSchedule" class="flex-1 flex items-center gap-3 overflow-x-auto no-scrollbar mask-gradient-x" style="height: 56px;">
              <span class="text-slate-200/85 animate-pulse" style="font-size:var(--sub);">ุฌุงุฑู ุฌูุจ ุงูุฌุฏูู...</span>
            </div>

            <div class="hidden xl:flex flex-col items-end border-r border-white/10 pr-4 mr-1 shrink-0 min-w-[180px]">
              <span class="text-slate-200 uppercase tracking-wide" style="font-size:11px;">ุงูุชุงูู ูุจุงุดุฑุฉ</span>
              <span id="nextLabel" class="font-black text-white truncate" style="font-size:var(--sub); max-width: 240px;">--</span>
            </div>
          </div>
        </div>

        <div class="absolute bottom-0 left-0 right-0 h-1 bg-slate-900/60">
          <div id="progressBar" class="h-full w-0 transition-all duration-1000"
               style="background:linear-gradient(90deg,var(--accent-main),var(--accent-sub),var(--accent-honor));"></div>
        </div>
      </section>

      <section class="bento-card honor-card-style flex-1 flex items-stretch px-6 md:px-8 relative overflow-hidden animate-enter min-h-0">
        <div class="flex items-center gap-6 md:gap-8 w-full z-10 h-full">
          <div class="flex flex-col gap-2 shrink-0 border-l border-[var(--accent-honor)]/45 pl-6 md:pl-8 justify-center min-w-[220px]">
            <div class="text-[var(--accent-honor)] font-black" style="font-size:clamp(22px,1.4vw,34px);">ููุญุฉ ุงูุดุฑู</div>
            <div class="text-amber-100/80 flex items-center gap-2" style="font-size:var(--meta);">
              <span><span id="exIndex" class="text-amber-50 font-black">0</span> / <span id="exTotal" class="font-black">0</span></span>
            </div>
          </div>

          <div id="exSlot" class="flex-1 flex items-center justify-start h-full min-w-0">
            <div class="h-full flex items-center justify-center text-slate-300 w-full" style="font-size:var(--sub);">
              ุฌุงุฑู ุงูุชุญููู...
            </div>
          </div>
        </div>
      </section>
    </div>

    <aside class="col-span-12 xl:col-span-4 flex flex-col min-h-0" style="gap:var(--gap);">
      <section class="bento-card flex-1 flex flex-col px-5 py-5 animate-enter min-h-0">
        <div class="flex justify-between items-center mb-3 pb-3 border-b border-white/5">
          <h3 class="font-black" style="color:var(--accent-ok); font-size:clamp(17px,1.05vw,24px);">ุญุตุต ุฌุงุฑูุฉ</h3>
          <span id="pcCount" class="chip chip-ok num-font" style="font-size:var(--slot-chip); padding:.26rem .65rem;">0</span>
        </div>
        <div class="standby-viewport flex-1 pr-1 min-h-0">
          <div id="periodClassesTrack" class="text-sm space-y-2"></div>
        </div>
      </section>

      <section class="bento-card flex-1 flex flex-col px-5 py-5 animate-enter min-h-0">
        <div class="flex justify-between items-center mb-3 pb-3 border-b border-white/5">
          <h3 class="font-black" style="color:var(--accent-warn); font-size:clamp(17px,1.05vw,24px);">ุญุตุต ุงูุงูุชุธุงุฑ</h3>
          <span id="sbCount" class="chip chip-warn num-font" style="font-size:var(--slot-chip); padding:.26rem .65rem;">0</span>
        </div>
        <div class="standby-viewport flex-1 pr-1 bg-gradient-to-br from-transparent to-black/10 rounded-2xl min-h-0">
          <div id="standbyTrack" class="text-sm space-y-2"></div>
        </div>
      </section>
    </aside>
  </main>

  <button
    id="fsBtn"
    class="fixed bottom-6 left-6 h-12 w-12 rounded-full bg-slate-950/85 backdrop-blur border border-slate-600/70 text-slate-300 hover:text-white hover:bg-[var(--accent-main)] transition-all flex items-center justify-center z-50 shadow-xl"
    type="button"
    aria-label="Fullscreen"
  >โถ</button>

  <script src="{% static 'js/display.js' %}?v=20251215-layout-alerts-rightcol"></script>
</body>
</html>
